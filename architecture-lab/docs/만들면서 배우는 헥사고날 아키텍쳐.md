# 만들면서 배우는 클린 아키텍처
## 1.계층형 아키텍쳐의 문제는 무엇일까?
#### 계층형 아키텍쳐는 데이터베이스 주도 설계를 유도한다.
웹 계층(컨트롤러) -> 도메인 계층(서비스) -> 영속성 계층(엔티티, 레포지토리) <br>
자연스럽게 영속성 계층에 의존하게 된다 <br>

영속성 중심적인 아키텍처가 만들어지는 가장 큰 원인은 ORM 때문이다 <br>

#### 지름길을 택하기 쉬워진다.
#### 테스트하기 어려워진다.
- 웹 계층 테스트에서 도메인 계층 뿐만 아니라, 영속성 계층도 Mocking 이 필요하다 -> 단위 테스트의 복잡도가 올라간다.<br>
#### 동시 작업이 어려워진다.

<br>

## 2.의존성 역전하기
계층형 아키텍쳐에 대한 대안을 이야기 해보자 <br>
먼저 단일책임원칙 과 의존성 역전 원칙에 대하여 알아보자 <br>

#### 단일책임원칙(SRP)
하나의 컴포넌트는 오로지 한가지 일만 해야하고, 그것을 올바르게 수행해야한다 는 원칙이다 <br>
좀 더 풀어서 자세히 설명하면, '컴포넌트를 변경하는 이유는 오직 하나뿐이어야 한다' <br>

컴포넌트를 변경할 이유가 오로지 한가지라면 어떤 다른 이유로 소프트웨어을 변경하더라도 컴포넌트에 대하여 전혀 신경 쓸 필요가 없다 <br>

#### 의존성 역전 원칙(DIP)
계층형 아키텍쳐에서 계층 간 의존성은 항상 다음 계층인 아래 방향을 가리킨다 <br>
즉 영속성 계층에 대한 도메인 계층의 의존성 때문에 영속성 계층을 변경할 때마다 잠재적으로 도메인 계층도 변경해야 한다 <br>

하지만 도메인 코드는 애플리케이션에서 가장 중요한 코드다. 영속성 코드가 바뀐다고 해서 도메인 코드도 변경되서는 안됀다 <br>

위 의존성을 어떻게 제거할 수 있을까?<br>
-> 의존성 역전 원칙을 사용한다 <br>

#### 클린 아키텍처
클린아키텍처에서는 설계가 비즈니스 규칙의 테스트를 용이하게 하고, 비즈니스 규칙은 프레임워크, 데이터베이스 UI 기술, 그 밖의 외부 어플리케이션이나 인터페이스로부터 독립적일 수 있다 <br>

이는 도메인 코드가 바깥으로 향하는 어떤 의존성도 없어야 함을 의미한다 <br>
대신 의존성 역전 원칙의 도움으로 모든 의존성이 도메인 코드를 향하고 있다 <br>
![the-clean-architecture.png](the-clean-architecture.png)





